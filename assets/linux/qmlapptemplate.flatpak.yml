id: io.emeric.qmlapptemplate
runtime: org.freedesktop.Platform
runtime-version: '21.08'
sdk: org.freedesktop.Sdk
command: qmlapptemplate

rename-desktop-file: qmlapptemplate.desktop
rename-appdata-file: qmlapptemplate.appdata.xml
rename-icon: qmlapptemplate

finish-args:
  # Our UI is GPU accelerated
  - --device=dri
  # X11 + XShm access
  - --share=ipc
  - --socket=fallback-x11
  # Wayland access
  - --socket=wayland
  # Needs to talk to the network
  - --share=network

modules:
  - name: qtbase
    build-options:
      arch:
        x86_64:
          config-opts:
            - -force-debug-info
        aarch64:
          cflags: -g0
          cxxflags: -g0
    config-opts:
      - -archdatadir
      - /app/lib/
      - -release
      - -opensource
      - -confirm-license
      - -cmake-use-default-generator
      - -openssl-linked
      - -no-feature-getentropy
      - -no-feature-renameat2
      - -no-feature-statx
      - -no-feature-highdpiscaling
      - -nomake
      - examples
      - -nomake
      - tests
    sources:
      - type: archive
        url: https://download.qt.io/development_releases/qt/6.3/6.3.0-beta2/submodules/qtbase-everywhere-src-6.3.0-beta2.tar.xz
        sha256: 3913e15adf6fe83ff377566e7effcbf5304f889dba18c6c67a8ce4f51af58674
    cleanup:
      - /bin
      - /lib/plugins/platformthemes/libqxdgdesktopportal.so

  - name: qtwayland
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=RelWithDebInfo
      - -DINPUT_egl_extension_platform_wayland=no
    sources:
      - type: archive
        url: https://download.qt.io/development_releases/qt/6.3/6.3.0-beta2/submodules/qtwayland-everywhere-src-6.3.0-beta2.tar.xz
        sha256: 3b4469f6a9ab8906b3b4bba4020ff501d8468b62e4000483fa5191d0d9d434e7
    cleanup:
      - /bin

  - name: qtimageformats
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=RelWithDebInfo
    sources:
      - type: archive
        url: https://download.qt.io/development_releases/qt/6.3/6.3.0-beta2/submodules/qtimageformats-everywhere-src-6.3.0-beta2.tar.xz
        sha256: 13d306bc6427ae182871343489ea8393a33646438780caa479c865d9d23919ef

  - name: qtsvg
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=RelWithDebInfo
    sources:
      - type: archive
        url: https://download.qt.io/development_releases/qt/6.3/6.3.0-beta2/submodules/qtsvg-everywhere-src-6.3.0-beta2.tar.xz
        sha256: 7e137694dd93dc205093dcf0ba386c80dddde915ce8e09667ea10c6057fe6736

  - name: qt5compat
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=RelWithDebInfo
    sources:
      - type: archive
        url: https://download.qt.io/development_releases/qt/6.3/6.3.0-beta2/submodules/qt5compat-everywhere-src-6.3.0-beta2.tar.xz
        sha256: fb2719630d9ae3ca16a8c9f2226b38492d88fc9df04dd74d70e5a83452877088

  - name: qmlapptemplate
    buildsystem: qmake
    sources:
      - type: archive
        url: https://github.com/emericg/QmlAppTemplate/archive/refs/tags/v0.3.tar.gz
        sha256: 8152e2f965039607a2f0e49ec11e655311e4ae43cb4dd7f47abd6693a672f0ee
